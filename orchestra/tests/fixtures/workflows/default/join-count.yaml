version: 1.0

description: A basic workflow that demonstrate join on count requirement.

tasks:
  task1:
    action: std.noop
    next:
      - when: <% task_state(task1) = "SUCCESS" %>
        do: task2, task4, task6

  # branch 1
  task2:
    action: std.noop
    next:
      - when: <% task_state(task2) = "SUCCESS" %>
        do: task3
  task3:
    action: std.noop
    next:
      - when: <% task_state(task3) = "SUCCESS" %>
        do: task8

  # branch 2
  task4:
    action: std.noop
    next:
      - when: <% task_state(task4) = "SUCCESS" %>
        do: task5
  task5:
    action: std.noop
    next:
      - when: <% task_state(task5) = "SUCCESS" %>
        do: task8

  # branch 3
  task6:
    action: std.noop
    next:
      - when: <% task_state(task6) = "SUCCESS" %>
        do: task7
  task7:
    action: std.noop
    next:
      - when: <% task_state(task7) = "SUCCESS" %>
        do: task8

  # converge branches
  task8:
    join: 2
    action: std.noop
