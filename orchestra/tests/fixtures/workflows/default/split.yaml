version: 1.0

description: >
  A basic workflow that demonstrate a split use case where a non-join task
  is referenced in more than one task transitions. The workflow is hence
  split into multiple branches from the non-join task.

tasks:
  task1:
    action: std.noop
    on-complete:
      - if: <% task_state(task1) = "SUCCESS" %>
        next:
          - task2
          - task3

  # branch 1
  task2:
    action: std.noop
    on-complete:
      - if: <% task_state(task2) = "SUCCESS" %>
        next:
          - task4

  # branch 2
  task3:
    action: std.noop
    on-complete:
      - if: <% task_state(task3) = "SUCCESS" %>
        next:
          - task4

  # split branch
  task4:
    action: std.noop
    on-complete:
      - if: <% task_state(task4) = "SUCCESS" %>
        next:
          - task5
          - task6
  task5:
    action: std.noop
    on-complete:
      - if: <% task_state(task5) = "SUCCESS" %>
        next:
          - task7
  task6:
    action: std.noop
    on-complete:
      - if: <% task_state(task6) = "SUCCESS" %>
        next:
          - task7
  task7:
    join: all
    action: std.noop
